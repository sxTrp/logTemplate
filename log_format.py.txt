import os
import random
from uuid import uuid1
from utils.constants import tmp_log_dir
from datetime import datetime


def update_datetime(create_time):
    # 更新时间格式
    result_date = str(create_time).strip().replace(" ", "T") + 'Z'
    return result_date


def create_id():
    # 创建不重复id
    m = str(uuid1())
    return m

def get_date_des():
    date_str = str(datetime.now())
    return date_str[:10].replace('-', '.')

def deal_base_log(log_info):
    head_des = '{"index":{"_index":"phone_base_info-%s","_type":"type1","_id":"%s"}}' % (get_date_des(), create_id())
    if "datetime" in log_info:
        log_info["datetime"] = update_datetime(log_info["datetime"])
    log_info = json.dumps(log_info)
    log_body = str(log_info).replace(': ', ':').replace(', ', ',').replace("'", '"')
    return head_des + '\n' + log_body
